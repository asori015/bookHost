<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>index</title>
    <meta name="generator" content="pdftohtml 0.36"/>
    <meta name="date" content="2009-10-16T23:21:09+00:00"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link rel="stylesheet" type="text/css" href="stylesheet.css"/>
<link rel="stylesheet" type="text/css" href="page_styles.css"/>
</head>
  <body class="calibre">
<h2 class="calibre5" id="calibre_pb_84">Chapter 5: Formatting</h2>
<p class="calibre1">that they can get 200 characters across the screen. Don’t do that. I personally set my limit at 120.</p>
<p class="calibre1"><a href="index_split_000.html#p11"><b class="calibre3">Horizontal Openness and Density</b></a></p>
<p class="calibre1">We use horizontal white space to associate things that are strongly related and disassociate things that are more weakly related. Consider the following function: private void measureLine(String line) {</p>
<p class="calibre1">lineCount++;</p>
<p class="calibre1">int lineSize = line.length();</p>
<p class="calibre1">totalChars += lineSize;</p>
<p class="calibre1">lineWidthHistogram.addLine(lineSize, lineCount);</p>
<p class="calibre1">recordWidestLine(lineSize);</p>
<p class="calibre1">}</p>
<p class="calibre1">I surrounded the assignment operators with white space to accentuate them. Assignment statements have two distinct and major elements: the left side and the right side. The spaces make that separation obvious.</p>
<p class="calibre1">On the other hand, I didn’t put spaces between the function names and the opening parenthesis. This is because the function and its arguments are closely related. Separating them makes them appear disjoined instead of conjoined. I separate arguments within the function call parenthesis to accentuate the comma and show that the arguments are separate.</p>
<p class="calibre1">Another use for white space is to accentuate the precedence of operators.</p>
<p class="calibre1">public class Quadratic {</p>
<p class="calibre1">public static double root1(double a, double b, double c) {</p>
<p class="calibre1">double determinant = determinant(a, b, c);</p>
<p class="calibre1">return (-b + Math.sqrt(determinant)) / (2*a);</p>
<p class="calibre1">}</p>
<p class="calibre1">public static double root2(int a, int b, int c) {</p>
<p class="calibre1">double determinant = determinant(a, b, c);</p>
<p class="calibre1">return (-b - Math.sqrt(determinant)) / (2*a);</p>
<p class="calibre1">}</p>
<p class="calibre1">private static double determinant(double a, double b, double c) {</p>
<p class="calibre1">return b*b - 4*a*c;</p>
<p class="calibre1">}</p>
<p class="calibre1">}</p>
<p class="calibre1">Notice how nicely the equations read. The factors have no white space between them because they are high precedence. The terms are separated by white space because addition and subtraction are lower precedence.</p>
<p class="calibre1">Unfortunately, most tools for reformatting code are blind to the precedence of operators and impose the same spacing throughout. So subtle spacings like those shown above tend to get lost after you reformat the code.</p>
<p class="calibre1"><a id="p118"></a><b class="calibre3">Horizontal Formatting</b></p>
<p class="calibre1">87</p>
<p class="calibre1"><a href="index_split_000.html#p11"><b class="calibre3">Horizontal Alignment</b></a></p>
<p class="calibre1">When I was an assembly language programmer,3 I used horizontal alignment to accentuate certain structures. When I started coding in C, C++, and eventually Java, I continued to try to line up all the variable names in a set of declarations, or all the rvalues in a set of assignment statements. My code might have looked like this: public class FitNesseExpediter implements ResponseSender</p>
<p class="calibre1">{</p>
<p class="calibre1">private   Socket          socket;</p>
<p class="calibre1">private   InputStream     input;</p>
<p class="calibre1">private   OutputStream    output;</p>
<p class="calibre1">private   Request         request;</p>
<p class="calibre1">private   Response        response;</p>
<p class="calibre1">private   FitNesseContext context;</p>
<p class="calibre1">protected long            requestParsingTimeLimit;</p>
<p class="calibre1">private   long            requestProgress;</p>
<p class="calibre1">private   long            requestParsingDeadline;</p>
<p class="calibre1">private   boolean         hasError;</p>
<p class="calibre1">public FitNesseExpediter(Socket          s,</p>
<p class="calibre1">FitNesseContext context) throws Exception</p>
<p class="calibre1">{</p>
<p class="calibre1">this.context =            context;</p>
<p class="calibre1">socket =                  s;</p>
<p class="calibre1">input =                   s.getInputStream();</p>
<p class="calibre1">output =                  s.getOutputStream();</p>
<p class="calibre1">requestParsingTimeLimit = 10000;</p>
<p class="calibre1">}</p>
<p class="calibre1">I have found, however, that this kind of alignment is not useful. The alignment seems to emphasize the wrong things and leads my eye away from the true intent. For example, in the list of declarations above you are tempted to read down the list of variable names without looking at their types. Likewise, in the list of assignment statements you are tempted to look down the list of rvalues without ever seeing the assignment operator. To make matters worse, automatic reformatting tools usually eliminate this kind of alignment.</p>
<p class="calibre1">So, in the end, I don’t do this kind of thing anymore. Nowadays I prefer unaligned declarations and assignments, as shown below, because they point out an important defi-ciency. If I have long lists that need to be aligned,  <i class="calibre4">the problem is the length of the lists</i>, not the lack of alignment. The length of the list of declarations in FitNesseExpediter below suggests that this class should be split up.</p>
<p class="calibre1">public class FitNesseExpediter implements ResponseSender</p>
<p class="calibre1">{</p>
<p class="calibre1">private Socket socket;</p>
<p class="calibre1">private InputStream input;</p>
<p class="calibre1">private OutputStream output;</p>
<p class="calibre1">private Request request;</p>
<p class="calibre1">3.</p>
<p class="calibre1">Who am I kidding? I still am an assembly language programmer. You can take the boy away from the metal, but you can’t take the metal out of the boy!</p>
<p class="calibre1"><a id="p119"></a>88</p>
<div class="calibre6" id="calibre_pb_85"></div>
</body>
</html>
